#!/bin/sh
# Custom newuidmap for bundled Podman on Linux
# Maps a range of UIDs to handle multi-UID images

# Arguments: $1 = PID, $2 = inner_uid, $3 = outer_uid, $4 = count
# Try to map 65536 UIDs first, fallback to single if that fails
echo "0 $(id -u) 65536" > /proc/$1/uid_map 2>/dev/null || \
echo "0 $(id -u) 1" > /proc/$1/uid_map 2>/dev/null || true
exit 0